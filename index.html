<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
  </head>
<script language="JavaScript">    
//JavaScript调用dll的公用方法  
//appName dll组件名（dll文件名） +　dll文件类名  
//methodName dll类中的方法名  
function run_dll(appName, methodName){  
  window.oldOnError = window.onerror;  
  window._command = appName;  
  window.onerror = function(err) {  
    if (err.indexOf('Automation') != -1) {  
      //alert('执行' + window._command + '过程中\n\r\n\r无法找到路径或被您禁止运行本地文件！');  
      alert('您未安装所需要的浏览器插件，请下载安装');  
      window.open('http://www.baidu.com/');  
      return true;  
    } else {  
      return false;  
    }  
  };  
  var obj = new ActiveXObject(appName);// dll组件名 +　dll文件类名  
  var result = obj[methodName]();  //dll类中的方法名  
  alert(result);   
}  
</script>  
<button onclick="run_dll('DLLTest.PI_Main','SayHello')">测试调用dll函数</button>  
</html>